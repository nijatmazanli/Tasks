<!-- products_table.ejs -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product List</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <style>
        /* Basic styling */
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 20px auto;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            border-radius: 5px;
            overflow: hidden;
        }
        h2 {
            background-color: #007bff;
            color: #fff;
            padding: 15px;
            margin: 0;
            text-align: center;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #f2f2f2;
        }
        td img {
            max-width: 80px;
            max-height: 80px;
            display: block;
            margin: 0 auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>Product List</h2>
        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Name</th>
                    <th>Price</th>
                    <th>Description</th>
                    <th>Category</th>
                    <th>Stock</th>
                    <th>Image</th>
                    <th>Created At</th>
                    <th>Updated At</th>
                </tr>
            </thead>
            <tbody>
                <% products.products.forEach(product => { %>
                    <tr>
                        <td><%= product.id %></td>
                        <td><%= product.name %></td>
                        <td>$ <%= product.price %></td>
                        <td><%= product.desc %></td>
                        <td><%= product.category %></td>
                        <td><%= product.stock %></td>
                        <td><img src="<%= product.imageUrl %>" alt="<%= product.name %>"></td>
                        <td><%= product.createdAt %></td>
                        <td><%= product.updatedAt %></td>
                        <td><button id="<%= product.id %>">Delete</button></td>
                    </tr>
                <% }); %>
            </tbody>
        </table>
        <a href="http://localhost:3000/create"> Create new </a>
    </div>
<script>
    const buttons = document.getElementsByTagName("button")
    buttons[0].addEventListener("click",(e) =>{
        const p_id = e.target.id
        console.log(p_id)
        
        axios.delete("http://localhost:3000/product/"+p_id)
    })
</script>
</body>
</html>